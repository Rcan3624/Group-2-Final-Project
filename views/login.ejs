<!doctype html>
<html lang="en">
  <head>
    <!-- Read head.ejs file from partials folder-->
    <%- include("./partials/head.ejs") %>
  </head>
  <body class="body">
    <!-- Read nav.ejs file from partials folder-->
    <%- include("./partials/nav.ejs") %>
    
        <h1 class="h1">Sign In</h1>
        <img class="logo rounded-pill float-lg-none" src="/images/logo.jpeg" alt="SCC Logo">

        <article class="float-left" style="min-width: 50%;">
        <form>
          <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" class="form-control" name="email" placeholder="Enter email address" >
            <div class="email error"></div>            
          
            <label for="password">Password</label>
            <input type="password" class="form-control" name="password" placeholder="Enter password">
            <div class="password error"></div>          
          </div>
            
            <button>Submit</button>

          </div>                   
          </form>
          
          <script>
            const form = document.querySelector('form');
            const emailError = document.querySelector('.email.error');
            const passwordError = document.querySelector('.password.error');
            
        
            form.addEventListener('submit', async (e) => {
              e.preventDefault();
              
              //reset errors
                emailError. textContent = '';
                passwordError.textContent = '';
                
      
              //get values
              const email = form.email.value;
              const password = form.password.value;
              
  
      
             try {

              const res = await fetch('/sunnydale/login', {
                method: 'POST',
                body: JSON.stringify({
                  email: email,
                  password: password
                  
                }),
                headers: {'Content-Type': 'application/json'}
              });

              const data = await res.json();
              console.log(data);

              if (data.errors) {
                emailError. textContent = data.errors.email;
                passwordError.textContent = data.errors.password;
              }

              if (data.user) {
                location.assign('/');
              }
             }
             catch (err) {

              console.log(err);

             };
            });
        </script>
        
        </article>
        <img class="float-right px-3 mr-2 my-5" src="/images/student2.png"  alt="Student" style="max-width: 30%; min-width: 30%;"> 

          <!--<button type="submit" class="btn btn-primary ml-3">Submit</button>
        </form>-->
        
    <!-- Read footer.ejs file from partials folder-->
    <footer>
      <%- include("./partials/footer.ejs") %>
    </footer>
  </body>
  
  

</html>